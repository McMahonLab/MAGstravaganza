mag_data <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Supplemental/MAG_information.csv", header = T)
mag_data$Taxonomy <- as.character(mag_data$Taxonomy)
# Make vector of last known classification
ID <- c()
for(i in 1:dim(mag_data)[1]){
taxonomy <- strsplit(mag_data$Taxonomy[i], ";")
ID[i] <- taxonomy[[1]][max(which(taxonomy[[1]] != "" & taxonomy[[1]] != "[Blank]"))]
}
ID[which(is.na(ID) == T)] <- "Unclassified"
mag_data$ID <- paste(ID, mag_data$IMG_OID, sep = "_")
phylum <- sapply(strsplit(mag_data$Taxonomy, ";"), '[', 1)
mag_data$Phylum <- phylum
# Read in IMG function data
enzymes <- read.csv("C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/IMG_function_data.csv")
enzymes[,2] <- as.character(enzymes[,2])
colnames(enzymes) <- enzymes[1,]
rownames(enzymes) <- enzymes[,1]
enzymes <- enzymes[2:17895, 2:206]
# What phyla are in Lake Mendota and how many MAGs are in each phylum?
mendota <- mag_data[which(mag_data$Lake == "Mendota"), ]
IMGOID <- mendota$IMG_OID[which(mendota$Phylum == "Proteobacteria")]
newnames <- mendota$ID[which(mendota$Phylum == "Proteobacteria")]
ME_proteo <- enzymes[,match(IMGOID, colnames(enzymes))]
colnames(ME_proteo) <- newnames
write.csv(ME_proteo, "C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/ME_proteo.csv")
write.csv(ME_proteo, "C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/ME_proteo.csv")
IMGOID <- mendota$IMG_OID[which(mendota$Phylum == "Chlamydiae" | mendota$Phylum == "Tenericutes" | mendota$Phylum == "Chloroflexi")]
newnames <- mendota$ID[which(mendota$Phylum == "Chlamydiae" | mendota$Phylum == "Tenericutes" | mendota$Phylum == "Chloroflexi")]
ME_other <- enzymes[,match(IMGOID, colnames(enzymes))]
colnames(ME_other) <- newnames
write.csv(ME_other, "C:/Users/Alex/Desktop/MAGstravaganza/Pathway_analysis/ME_other.csv")
grep("Tenericutes", mag_data)
mag_data[c(4,11,12),]
grep("Tenericutes", mag_data$Taxonomy)
mag_data$Taxonomy[c(3,98)]
mag_data[c(3,98),]
IMGOID <- mendota$IMG_OID[which(mendota$Phylum == "Chlamydiae" | mendota$Phylum == "Tenericutes" | mendota$Phylum == "Chloroflexi")]
IMGOID
newnames <- mendota$ID[which(mendota$Phylum == "Chlamydiae" | mendota$Phylum == "Tenericutes" | mendota$Phylum == "Chloroflexi")]
newnames
