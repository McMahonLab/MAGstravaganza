trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p3 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2010" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2010") + scale_color_brewer(palette = "Set1")
trace1 <- trace2011[which(trace2011$OID == "2582580518"), ]
trace2 <- trace2011[which(trace2011$OID == "2582580525"), ]
trace3 <- trace2011[which(trace2011$OID == "2582580531"), ]
trace4 <- trace2011[which(trace2011$OID == "2582580537"), ]
trace5 <- trace2011[which(trace2011$OID == "2582580551"), ]
trace6 <- trace2011[which(trace2011$OID == "2582580552"), ]
# trace7 <- trace2011[which(trace2011$OID == "2582580567"), ]
trace8 <- trace2011[which(trace2011$OID == "2582580576"), ]
# trace9 <- trace2011[which(trace2011$OID == "2582580577"), ]
trace10 <- trace2011[which(trace2011$OID == "2582580584"), ]
# trace11 <- trace2011[which(trace2011$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p4 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2011" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2011") + scale_color_brewer(palette = "Set1")
trace1 <- trace2012[which(trace2012$OID == "2582580518"), ]
trace2 <- trace2012[which(trace2012$OID == "2582580525"), ]
trace3 <- trace2012[which(trace2012$OID == "2582580531"), ]
trace4 <- trace2012[which(trace2012$OID == "2582580537"), ]
trace5 <- trace2012[which(trace2012$OID == "2582580551"), ]
trace6 <- trace2012[which(trace2012$OID == "2582580552"), ]
# trace7 <- trace2012[which(trace2012$OID == "2582580567"), ]
trace8 <- trace2012[which(trace2012$OID == "2582580576"), ]
# trace9 <- trace2012[which(trace2012$OID == "2582580577"), ]
trace10 <- trace2012[which(trace2012$OID == "2582580584"), ]
# trace11 <- trace2012[which(trace2012$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p5 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2012" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2012") + scale_color_brewer(palette = "Set1")
all <- plot_grid(p1, p2, p3, p4, p5, nrow = 5, labels = c("A", "B", "C", "D", "E"))
all
p1
p2
Mendota_raw_input <- read.table("C:/Users/Goose and Gander/Desktop/MAGstravaganza/time_series_mapping/Mendota_results.txt", colClasses = c("character", "character", "numeric", "numeric"))
Mendota_dates <- read.table("C:/Users/Goose and Gander/Desktop/MAGstravaganza/time_series_mapping/ME.sampledata.filtered.tsv", sep = "\t", header = T)
Mendota_dates$sample <- as.character(Mendota_dates$sample)
metadata <- read.csv("C:/Users/Goose and Gander/Desktop/MAGstravaganza/Supplemental/MAG_information.csv", header = T)
# Convert to RPKM (reads per kilobase per million reads) ish - not really RPKM because it's for metagenomes
# general form: RPKM =   numReads / ( genomeLength/1000 * totalNumReads/1,000,000 )
size_vector <- metadata$Genome_Size[match(Mendota_raw_input$V1, metadata$IMG_OID)]
Mendota_RPKM <- Mendota_raw_input$V3/(size_vector/1000 * Mendota_raw_input$V4/1000000)
ME_results <- data.frame(Mendota_raw_input[,1:2], Mendota_RPKM)
colnames(ME_results) <- c("MAG", "metaG", "RPKM")
ME_results$Date <- as.Date(Mendota_dates$date[match(ME_results$metaG, Mendota_dates$sample)], format = "%m/%d/%y")
ME_results$Julian_Date <- as.numeric(format(ME_results$Date, "%j"))
ME_results <- ME_results[which(is.na(ME_results$Date) == F),]
# Get taxonomy
metadata$phylum <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 1)
ME_results$phylum <- metadata$phylum[match(ME_results$MAG, metadata$IMG_OID)]
ME_results$year <- substr(ME_results$Date, start = 1, stop = 4)
seasons <- data.frame(x1 = c(75, 152, 244), x2 = c(151, 243, 334), y1 = c(0, 0, 0), y2 = c(Inf, Inf, Inf))
trace <- data.frame(input = ME_results$RPKM[which(ME_results$phylum == "Cyanobacteria")], dates = ME_results$Julian_Date[which(ME_results$phylum == "Cyanobacteria")], year = ME_results$year[which(ME_results$phylum == "Cyanobacteria")],OID = ME_results$MAG[which(ME_results$phylum == "Cyanobacteria")])
trace <- trace[order(trace$dates),]
trace2008 <- trace[which(trace$year == "2008"), ]
trace2009 <- trace[which(trace$year == "2009"), ]
trace2010 <- trace[which(trace$year == "2010"), ]
trace2011 <- trace[which(trace$year == "2011"), ]
trace2012 <- trace[which(trace$year == "2012"), ]
trace1 <- trace2008[which(trace2008$OID == "2582580518"), ]
trace2 <- trace2008[which(trace2008$OID == "2582580525"), ]
trace3 <- trace2008[which(trace2008$OID == "2582580531"), ]
trace4 <- trace2008[which(trace2008$OID == "2582580537"), ]
trace5 <- trace2008[which(trace2008$OID == "2582580551"), ]
trace6 <- trace2008[which(trace2008$OID == "2582580552"), ]
#trace7 <- trace2008[which(trace2008$OID == "2582580567"), ]
trace8 <- trace2008[which(trace2008$OID == "2582580576"), ]
#trace9 <- trace2008[which(trace2008$OID == "2582580577"), ]
trace10 <- trace2008[which(trace2008$OID == "2582580584"), ]
#trace11 <- trace2008[which(trace2008$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
#trace7 <- trace7[order(trace7$dates),]
#trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
#trace9 <- trace9[order(trace9$dates),]
#trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
#trace11 <- trace11[order(trace11$dates),]
#trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p1 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_brewer(palette = "Set1")
trace1 <- trace2009[which(trace2009$OID == "2582580518"), ]
trace2 <- trace2009[which(trace2009$OID == "2582580525"), ]
trace3 <- trace2009[which(trace2009$OID == "2582580531"), ]
trace4 <- trace2009[which(trace2009$OID == "2582580537"), ]
trace5 <- trace2009[which(trace2009$OID == "2582580551"), ]
trace6 <- trace2009[which(trace2009$OID == "2582580552"), ]
# trace7 <- trace2009[which(trace2009$OID == "2582580567"), ]
trace8 <- trace2009[which(trace2009$OID == "2582580576"), ]
# trace9 <- trace2009[which(trace2009$OID == "2582580577"), ]
trace10 <- trace2009[which(trace2009$OID == "2582580584"), ]
# trace11 <- trace2009[which(trace2009$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p2 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2009" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2009") + scale_color_brewer(palette = "Set1")
trace1 <- trace2010[which(trace2010$OID == "2582580518"), ]
trace2 <- trace2010[which(trace2010$OID == "2582580525"), ]
trace3 <- trace2010[which(trace2010$OID == "2582580531"), ]
trace4 <- trace2010[which(trace2010$OID == "2582580537"), ]
trace5 <- trace2010[which(trace2010$OID == "2582580551"), ]
trace6 <- trace2010[which(trace2010$OID == "2582580552"), ]
#trace7 <- trace2010[which(trace2010$OID == "2582580567"), ]
trace8 <- trace2010[which(trace2010$OID == "2582580576"), ]
#trace9 <- trace2010[which(trace2010$OID == "2582580577"), ]
trace10 <- trace2010[which(trace2010$OID == "2582580584"), ]
#trace11 <- trace2010[which(trace2010$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p3 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2010" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2010") + scale_color_brewer(palette = "Set1")
trace1 <- trace2011[which(trace2011$OID == "2582580518"), ]
trace2 <- trace2011[which(trace2011$OID == "2582580525"), ]
trace3 <- trace2011[which(trace2011$OID == "2582580531"), ]
trace4 <- trace2011[which(trace2011$OID == "2582580537"), ]
trace5 <- trace2011[which(trace2011$OID == "2582580551"), ]
trace6 <- trace2011[which(trace2011$OID == "2582580552"), ]
# trace7 <- trace2011[which(trace2011$OID == "2582580567"), ]
trace8 <- trace2011[which(trace2011$OID == "2582580576"), ]
# trace9 <- trace2011[which(trace2011$OID == "2582580577"), ]
trace10 <- trace2011[which(trace2011$OID == "2582580584"), ]
# trace11 <- trace2011[which(trace2011$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p4 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2011" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2011") + scale_color_brewer(palette = "Set1")
trace1 <- trace2012[which(trace2012$OID == "2582580518"), ]
trace2 <- trace2012[which(trace2012$OID == "2582580525"), ]
trace3 <- trace2012[which(trace2012$OID == "2582580531"), ]
trace4 <- trace2012[which(trace2012$OID == "2582580537"), ]
trace5 <- trace2012[which(trace2012$OID == "2582580551"), ]
trace6 <- trace2012[which(trace2012$OID == "2582580552"), ]
# trace7 <- trace2012[which(trace2012$OID == "2582580567"), ]
trace8 <- trace2012[which(trace2012$OID == "2582580576"), ]
# trace9 <- trace2012[which(trace2012$OID == "2582580577"), ]
trace10 <- trace2012[which(trace2012$OID == "2582580584"), ]
# trace11 <- trace2012[which(trace2012$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p5 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2012" & ME_results$MAG != "2582580567" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2012") + scale_color_brewer(palette = "Set1")
all <- plot_grid(p1, p2, p3, p4, p5, nrow = 5, labels = c("A", "B", "C", "D", "E"))
#save_plot("C:/Users/Alex/Desktop/MAGstravaganza/Manuscript_plots/Fig5.pdf", meth, base_height = 5, base_aspect_ratio = 3)
all
all
Mendota_raw_input <- read.table("C:/Users/Goose and Gander/Desktop/MAGstravaganza/time_series_mapping/Mendota_results.txt", colClasses = c("character", "character", "numeric", "numeric"))
Mendota_dates <- read.table("C:/Users/Goose and Gander/Desktop/MAGstravaganza/time_series_mapping/ME.sampledata.filtered.tsv", sep = "\t", header = T)
Mendota_dates$sample <- as.character(Mendota_dates$sample)
metadata <- read.csv("C:/Users/Goose and Gander/Desktop/MAGstravaganza/Supplemental/MAG_information.csv", header = T)
# Convert to RPKM (reads per kilobase per million reads) ish - not really RPKM because it's for metagenomes
# general form: RPKM =   numReads / ( genomeLength/1000 * totalNumReads/1,000,000 )
size_vector <- metadata$Genome_Size[match(Mendota_raw_input$V1, metadata$IMG_OID)]
Mendota_RPKM <- Mendota_raw_input$V3/(size_vector/1000 * Mendota_raw_input$V4/1000000)
ME_results <- data.frame(Mendota_raw_input[,1:2], Mendota_RPKM)
colnames(ME_results) <- c("MAG", "metaG", "RPKM")
ME_results$Date <- as.Date(Mendota_dates$date[match(ME_results$metaG, Mendota_dates$sample)], format = "%m/%d/%y")
ME_results$Julian_Date <- as.numeric(format(ME_results$Date, "%j"))
ME_results <- ME_results[which(is.na(ME_results$Date) == F),]
# Get taxonomy
metadata$phylum <- sapply(strsplit(as.character(metadata$Taxonomy),";"), `[`, 1)
ME_results$phylum <- metadata$phylum[match(ME_results$MAG, metadata$IMG_OID)]
ME_results$year <- substr(ME_results$Date, start = 1, stop = 4)
seasons <- data.frame(x1 = c(75, 152, 244), x2 = c(151, 243, 334), y1 = c(0, 0, 0), y2 = c(Inf, Inf, Inf))
trace <- data.frame(input = ME_results$RPKM[which(ME_results$phylum == "Cyanobacteria")], dates = ME_results$Julian_Date[which(ME_results$phylum == "Cyanobacteria")], year = ME_results$year[which(ME_results$phylum == "Cyanobacteria")],OID = ME_results$MAG[which(ME_results$phylum == "Cyanobacteria")])
trace <- trace[order(trace$dates),]
trace2008 <- trace[which(trace$year == "2008"), ]
trace2009 <- trace[which(trace$year == "2009"), ]
trace2010 <- trace[which(trace$year == "2010"), ]
trace2011 <- trace[which(trace$year == "2011"), ]
trace2012 <- trace[which(trace$year == "2012"), ]
trace1 <- trace2008[which(trace2008$OID == "2582580518"), ]
trace2 <- trace2008[which(trace2008$OID == "2582580525"), ]
trace3 <- trace2008[which(trace2008$OID == "2582580531"), ]
trace4 <- trace2008[which(trace2008$OID == "2582580537"), ]
trace5 <- trace2008[which(trace2008$OID == "2582580551"), ]
trace6 <- trace2008[which(trace2008$OID == "2582580552"), ]
#trace7 <- trace2008[which(trace2008$OID == "2582580567"), ]
trace8 <- trace2008[which(trace2008$OID == "2582580576"), ]
#trace9 <- trace2008[which(trace2008$OID == "2582580577"), ]
trace10 <- trace2008[which(trace2008$OID == "2582580584"), ]
#trace11 <- trace2008[which(trace2008$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
#trace7 <- trace7[order(trace7$dates),]
#trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
#trace9 <- trace9[order(trace9$dates),]
#trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
#trace11 <- trace11[order(trace11$dates),]
#trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p1 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_manual(values = c("#a6611a")) + scale_y_continuous(limits = c(0, 100))
trace1 <- trace2009[which(trace2009$OID == "2582580518"), ]
trace2 <- trace2009[which(trace2009$OID == "2582580525"), ]
trace3 <- trace2009[which(trace2009$OID == "2582580531"), ]
trace4 <- trace2009[which(trace2009$OID == "2582580537"), ]
trace5 <- trace2009[which(trace2009$OID == "2582580551"), ]
trace6 <- trace2009[which(trace2009$OID == "2582580552"), ]
# trace7 <- trace2009[which(trace2009$OID == "2582580567"), ]
trace8 <- trace2009[which(trace2009$OID == "2582580576"), ]
# trace9 <- trace2009[which(trace2009$OID == "2582580577"), ]
trace10 <- trace2009[which(trace2009$OID == "2582580584"), ]
# trace11 <- trace2009[which(trace2009$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p2 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2009" & ME_results$MAG == "2582580537"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2009") + scale_color_manual(values = c("#018571")) + scale_y_continuous(limits = c(0, 100))
trace1 <- trace2010[which(trace2010$OID == "2582580518"), ]
trace2 <- trace2010[which(trace2010$OID == "2582580525"), ]
trace3 <- trace2010[which(trace2010$OID == "2582580531"), ]
trace4 <- trace2010[which(trace2010$OID == "2582580537"), ]
trace5 <- trace2010[which(trace2010$OID == "2582580551"), ]
trace6 <- trace2010[which(trace2010$OID == "2582580552"), ]
#trace7 <- trace2010[which(trace2010$OID == "2582580567"), ]
trace8 <- trace2010[which(trace2010$OID == "2582580576"), ]
#trace9 <- trace2010[which(trace2010$OID == "2582580577"), ]
trace10 <- trace2010[which(trace2010$OID == "2582580584"), ]
#trace11 <- trace2010[which(trace2010$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p3 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2010" & ME_results$MAG != "2582580551" & ME_results$MAG != "2582580577" & ME_results$MAG != "2582580591"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2010") + scale_color_manual(values = c("#4dac26")) + scale_y_continuous(limits = c(0, 100))
trace1 <- trace2011[which(trace2011$OID == "2582580518"), ]
trace2 <- trace2011[which(trace2011$OID == "2582580525"), ]
trace3 <- trace2011[which(trace2011$OID == "2582580531"), ]
trace4 <- trace2011[which(trace2011$OID == "2582580537"), ]
trace5 <- trace2011[which(trace2011$OID == "2582580551"), ]
trace6 <- trace2011[which(trace2011$OID == "2582580552"), ]
# trace7 <- trace2011[which(trace2011$OID == "2582580567"), ]
trace8 <- trace2011[which(trace2011$OID == "2582580576"), ]
# trace9 <- trace2011[which(trace2011$OID == "2582580577"), ]
trace10 <- trace2011[which(trace2011$OID == "2582580584"), ]
# trace11 <- trace2011[which(trace2011$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p4 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2011" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2011") + scale_color_manual(values = c("#a6611a")) + scale_y_continuous(limits = c(0, 100))
trace1 <- trace2012[which(trace2012$OID == "2582580518"), ]
trace2 <- trace2012[which(trace2012$OID == "2582580525"), ]
trace3 <- trace2012[which(trace2012$OID == "2582580531"), ]
trace4 <- trace2012[which(trace2012$OID == "2582580537"), ]
trace5 <- trace2012[which(trace2012$OID == "2582580551"), ]
trace6 <- trace2012[which(trace2012$OID == "2582580552"), ]
# trace7 <- trace2012[which(trace2012$OID == "2582580567"), ]
trace8 <- trace2012[which(trace2012$OID == "2582580576"), ]
# trace9 <- trace2012[which(trace2012$OID == "2582580577"), ]
trace10 <- trace2012[which(trace2012$OID == "2582580584"), ]
# trace11 <- trace2012[which(trace2012$OID == "2582580591"), ]
trace1 <- trace1[order(trace1$dates),]
trace1$line <- c(trace1$input[1], mean(trace1$input[1:2]), rollmean(trace1$input, 3))
trace2 <- trace2[order(trace2$dates),]
trace2$line <- c(trace2$input[1], mean(trace2$input[1:2]), rollmean(trace2$input, 3))
trace3 <- trace3[order(trace3$dates),]
trace3$line <- c(trace3$input[1], mean(trace3$input[1:2]), rollmean(trace3$input, 3))
trace4 <- trace4[order(trace4$dates),]
trace4$line <- c(trace4$input[1], mean(trace4$input[1:2]), rollmean(trace4$input, 3))
trace5 <- trace5[order(trace5$dates),]
trace5$line <- c(trace5$input[1], mean(trace5$input[1:2]), rollmean(trace5$input, 3))
trace6 <- trace6[order(trace6$dates),]
trace6$line <- c(trace6$input[1], mean(trace6$input[1:2]), rollmean(trace6$input, 3))
# trace7 <- trace7[order(trace7$dates),]
# trace7$line <- c(trace7$input[1], mean(trace7$input[1:2]), rollmean(trace7$input, 3))
trace8 <- trace8[order(trace8$dates),]
trace8$line <- c(trace8$input[1], mean(trace8$input[1:2]), rollmean(trace8$input, 3))
# trace9 <- trace9[order(trace9$dates),]
# trace9$line <- c(trace9$input[1], mean(trace9$input[1:2]), rollmean(trace9$input, 3))
trace10 <- trace10[order(trace10$dates),]
trace10$line <- c(trace10$input[1], mean(trace10$input[1:2]), rollmean(trace10$input, 3))
# trace11 <- trace11[order(trace11$dates),]
# trace11$line <- c(trace11$input[1], mean(trace11$input[1:2]), rollmean(trace11$input, 3))
trace <- rbind(trace1, trace2, trace3, trace4, trace5, trace6, trace8, trace10)
p5 <- ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2012" & ME_results$MAG == "2582580584"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", main = "2012") + scale_color_manual(values = c("#d01c8b")) + scale_y_continuous(limits = c(0, 100))
all <- plot_grid(p1, p2, p3, p4, p5, nrow = 5, labels = c("A", "B", "C", "D", "E"))
#save_plot("C:/Users/Alex/Desktop/MAGstravaganza/Manuscript_plots/Fig5.pdf", meth, base_height = 5, base_aspect_ratio = 3)
all
p1
p2
ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace1, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_manual(values = c("#a6611a")) + scale_y_continuous(limits = c(0, 100))
ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace1, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_manual(values = c("#a6611a")) + scale_y_continuous(limits = c(0, 120))
ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace1, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_manual(values = c("#a6611a")) + scale_y_continuous(limits = c(0, 120))
ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2) + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + labs(x = "Date") + scale_x_continuous(breaks = pretty(ME_results$Julian_Date, 30), limits = c(75, 334)) + geom_rect(data = seasons, inherit.aes = FALSE, aes(xmin = x1, xmax = x2, ymin = y1, ymax = y2), alpha = 0.1, fill = c("skyblue", "springgreen", "goldenrod"), color = "black") + geom_line(data = trace1, aes(y = line, x = dates, color = OID), size = 2) + labs(x = "Julian Date", y = "Normalized Read Count", title = "2008") + scale_color_manual(values = c("#a6611a"))
ggplot(data = ME_results[which(ME_results$phylum == "Cyanobacteria" & ME_results$year == "2008" & ME_results$MAG == "2582580518"), ], aes(x = Julian_Date, y = RPKM, color = MAG)) + geom_point(size = 2)
